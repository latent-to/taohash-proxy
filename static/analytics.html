<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TaoHash Analytics</title>
  <link rel="stylesheet" href="/static/styles.css">
  <link rel="stylesheet" href="/static/analytics.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
</head>
<body>
  <div class="container">
    <header>
      <div class="logo-title">
        <h1><span class="tao-letter">t</span>ao hash <span class="subtitle">analytics</span></h1>
      </div>
      <div class="nav-links">
        <a href="/" class="nav-link">‚Üê Back to Dashboard</a>
      </div>
    </header>

    <!-- Pool Statistics Summary -->
    <div class="stats-summary">
      <div class="stat-card">
        <div class="stat-label">24h Pool Hashrate</div>
        <div class="stat-value" id="poolHashrate">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Active Workers</div>
        <div class="stat-value" id="activeWorkers">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">24h Shares</div>
        <div class="stat-value" id="totalShares">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Best Share (24h)</div>
        <div class="stat-value" id="bestShare">-</div>
      </div>
    </div>

    <!-- Share Query Section -->
    <section class="card">
      <h2>Query Share History</h2>
      <div class="query-form">
        <div class="form-row">
          <div class="form-group">
            <label for="workerFilter">Worker Name</label>
            <input type="text" id="workerFilter" class="form-control" placeholder="Leave empty for all workers">
          </div>
          <div class="form-group">
            <label for="timeRange">Time Range</label>
            <select id="timeRange" class="form-control">
              <option value="1h">Last Hour</option>
              <option value="6h">Last 6 Hours</option>
              <option value="24h" selected>Last 24 Hours</option>
              <option value="7d">Last 7 Days</option>
              <option value="custom">Custom Range</option>
            </select>
          </div>
        </div>

        <div id="customTimeRange" class="form-row" style="display: none;">
          <div class="form-group">
            <label for="startTime">Start Time</label>
            <input type="datetime-local" id="startTime" class="form-control">
          </div>
          <div class="form-group">
            <label for="endTime">End Time</label>
            <input type="datetime-local" id="endTime" class="form-control">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="minDifficulty">Min Actual Difficulty</label>
            <input type="number" id="minDifficulty" class="form-control" placeholder="Optional: e.g., 1000000">
          </div>
          <div class="form-group">
            <label for="shareStatus">Share Status</label>
            <select id="shareStatus" class="form-control">
              <option value="all">All Shares</option>
              <option value="accepted">Accepted Only</option>
              <option value="rejected">Rejected Only</option>
            </select>
          </div>
        </div>

        <div class="button-group">
          <button id="queryShares" class="btn btn-primary">Query Shares</button>
          <button id="resetForm" class="btn btn-secondary">Reset</button>
        </div>
      </div>
    </section>

    <!-- Results Section -->
    <section id="resultsSection" class="card" style="display: none;">
      <div class="results-header">
        <h2>Share History</h2>
        <div class="export-buttons">
          <button id="exportCsv" class="btn btn-small">Export CSV</button>
          <button id="exportJson" class="btn btn-small">Export JSON</button>
        </div>
      </div>
      
      <div id="resultsSummary" class="results-summary"></div>
      
      <div class="table-container">
        <table id="resultsTable">
          <thead>
            <tr>
              <th>Time</th>
              <th>Worker</th>
              <th>Pool Diff</th>
              <th>Actual Diff</th>
              <th>Luck</th>
              <th>Status</th>
              <th>Job ID</th>
            </tr>
          </thead>
          <tbody id="resultsBody"></tbody>
        </table>
      </div>
      
      <div id="loadMore" class="load-more" style="display: none;">
        <button id="loadMoreBtn" class="btn btn-secondary">Load More</button>
      </div>
    </section>

    <!-- Top Workers Section -->
    <section class="card">
      <h2>Top Workers (24 Hours)</h2>
      <div class="table-container">
        <table id="workersTable">
          <thead>
            <tr>
              <th>Worker</th>
              <th>Hashrate</th>
              <th>Shares</th>
              <th>Accept Rate</th>
              <th>Best Share</th>
              <th>Avg Luck</th>
            </tr>
          </thead>
          <tbody id="workersBody">
            <tr><td colspan="6" class="loading">Loading...</td></tr>
          </tbody>
        </table>
      </div>
    </section>
  </div>

  <script src="/static/analytics.js"></script>
</body>
</html>